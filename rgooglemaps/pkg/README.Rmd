---
title: "RgoogleMaps and API keys"
output:
  md_document:
    variant: markdown_github
---


```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE, cache = FALSE,
  comment = "# ",
  fig.path = "tools/README-",
  dpi = 67
)
```

Google has recently changed its API requirements, and users are now required to register with Google. 
	
You can do this at https://cloud.google.com/maps-platform/. The API key requires a valid credit card which makes me very uncomfortable.
So instead we have a workaround using map tiles:

```{r}
library(RgoogleMaps)

lat = c(40.702147,40.718217,40.711614);
lon = c(-74.012318,-74.015794,-73.998284);
center = c(mean(lat), mean(lon));
zoom <- min(MaxZoom(range(lat), range(lon)));
bb=qbbox(lat,lon)

```


#### Openstreet map server

```{r}

par(pty="s")
#OSM
myMap=GetMap(center,zoom=15)
PlotOnStaticMap(myMap,lat=lat,lon=lon,pch=20,col=c('red', 'blue', 'green'),cex=2)

```


#### Google map server

```{r}
#Google
myMap=GetMap(center,zoom=15,urlBase = "http://mt1.google.com/vt/lyrs=m", tileDir= "~/mapTiles/Google/")
PlotOnStaticMap(myMap,lat=lat,lon=lon,pch=20,col=c('red', 'blue', 'green'),cex=2)

```


Note that for each geographic region there is a one-time only download of map tiles that are needed to "stitch" together the static map. Afterwards, repeated calls simply access the stored offline map tiles. (When you change the zoom level or the locations, you will download more tiles.)